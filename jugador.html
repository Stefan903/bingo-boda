<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo de Boda - Arnick & Paola</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
        * { font-family: 'Poppins', sans-serif; }
        
        @keyframes gradient-shift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes float { 0%, 100% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-15px) rotate(5deg); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes confetti-fall { 0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
        @keyframes pulse-ring { 0% { transform: scale(0.8); opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
            background-size: 400% 400%;
            animation: gradient-shift 10s ease infinite;
        }
        
        .float { animation: float 3s ease-in-out infinite; }
        .bounce { animation: bounce 1s ease-in-out infinite; }
        .confetti { animation: confetti-fall 3s linear forwards; }
        .pulse-ring { animation: pulse-ring 1.5s ease-out infinite; }
        .slide-up { animation: slideUp 0.5s ease-out forwards; }
        
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .glow { box-shadow: 0 0 20px rgba(168, 85, 247, 0.4), 0 0 40px rgba(168, 85, 247, 0.2); }
        .winner-glow { box-shadow: 0 0 30px rgba(251, 191, 36, 0.6), 0 0 60px rgba(251, 191, 36, 0.3); }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Decoraciones flotantes -->
    <div class="fixed inset-0 pointer-events-none overflow-hidden z-0">
        <div class="absolute top-10 left-10 text-6xl opacity-30 float" style="animation-delay: 0s;">ğŸ’•</div>
        <div class="absolute top-1/4 right-10 text-5xl opacity-30 float" style="animation-delay: 0.5s;">âœ¨</div>
        <div class="absolute bottom-20 left-20 text-5xl opacity-30 float" style="animation-delay: 1s;">ğŸ’</div>
        <div class="absolute top-1/2 left-1/3 text-4xl opacity-30 float" style="animation-delay: 1.5s;">ğŸ‰</div>
        <div class="absolute bottom-1/3 right-1/4 text-5xl opacity-30 float" style="animation-delay: 2s;">ğŸŒŸ</div>
    </div>

    <!-- Pantalla de registro -->
    <div id="registerScreen" class="min-h-screen flex items-center justify-center p-4 relative z-10">
        <div class="glass rounded-3xl shadow-2xl p-10 max-w-md w-full slide-up glow">
            <div class="text-center mb-8">
                <div class="relative inline-block mb-4">
                    <div class="absolute inset-0 pulse-ring bg-pink-300 rounded-full"></div>
                    <div class="text-7xl bounce relative z-10">ğŸ’•</div>
                </div>
                <h1 class="text-4xl font-bold bg-gradient-to-r from-purple-600 via-pink-600 to-purple-600 bg-clip-text text-transparent mb-3">
                    Bingo de Boda
                </h1>
                <div class="flex items-center justify-center gap-2 mb-2">
                    <span class="text-2xl">ğŸ’</span>
                    <p class="text-2xl font-bold text-purple-600">Arnick & Paola</p>
                    <span class="text-2xl">ğŸ’</span>
                </div>
                <div class="bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-4 mt-4">
                    <p class="text-gray-700 font-semibold">Â¡Completa las 12 casillas para ganar!</p>
                    <p class="text-sm text-gray-600 mt-1">Encuentra personas que cumplan cada caracterÃ­stica</p>
                </div>
            </div>
            
            <div class="space-y-4">
                <div class="relative">
                    <input
                        type="text"
                        id="playerNameInput"
                        placeholder="Escribe tu nombre aquÃ­..."
                        class="w-full px-6 py-4 border-3 border-purple-300 rounded-2xl focus:border-purple-500 focus:outline-none text-lg font-medium shadow-lg transition-all"
                    />
                    <div class="absolute right-4 top-1/2 transform -translate-y-1/2 text-2xl">âœï¸</div>
                </div>
                <button
                    onclick="registerPlayer()"
                    class="w-full py-4 bg-gradient-to-r from-purple-500 via-pink-500 to-purple-500 text-white rounded-2xl font-bold text-lg hover:shadow-2xl transition-all transform hover:scale-105 glow"
                >
                    ğŸ® Â¡Empezar a Jugar!
                </button>
            </div>

            <div class="mt-8 bg-white/80 backdrop-blur rounded-2xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-2xl">ğŸ“‹</span>
                    <p class="text-lg font-bold text-purple-700">Â¿CÃ³mo jugar?</p>
                </div>
                <ul class="space-y-2 text-sm text-gray-700">
                    <li class="flex items-start gap-2">
                        <span class="text-purple-500 font-bold">1.</span>
                        <span>Escucha atentamente al presentador</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="text-purple-500 font-bold">2.</span>
                        <span>Busca personas que cumplan cada pregunta</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="text-purple-500 font-bold">3.</span>
                        <span>Marca la casilla cuando encuentres a alguien</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="text-purple-500 font-bold">4.</span>
                        <span class="font-bold text-purple-600">Â¡Completa las 12 y gana!</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Pantalla de juego -->
    <div id="gameScreen" class="hidden min-h-screen p-4 relative z-10">
        <div id="confettiContainer" class="fixed inset-0 pointer-events-none z-50"></div>

        <div class="max-w-5xl mx-auto">
            <!-- Header del jugador -->
            <div class="glass rounded-3xl shadow-2xl p-6 mb-6 slide-up glow">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-14 h-14 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-2xl">
                            ğŸ‘¤
                        </div>
                        <div>
                            <h1 id="playerNameDisplay" class="text-2xl font-bold text-gray-800"></h1>
                            <p class="text-purple-600 font-medium">Jugador Activo âš¡</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-2xl">
                            <div class="flex items-center gap-2 justify-end mb-1">
                                <span class="text-2xl">âœ¨</span>
                                <span id="progressCount" class="text-3xl font-bold">0/12</span>
                            </div>
                            <p class="text-xs opacity-90 font-medium">Completado</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Banner de ganador -->
            <div id="winnerBanner" class="hidden mb-6 slide-up">
                <div class="bg-gradient-to-r from-yellow-400 via-yellow-500 to-orange-500 rounded-3xl p-8 text-center shadow-2xl winner-glow border-4 border-yellow-300">
                    <div class="text-7xl mb-4 bounce">ğŸ†</div>
                    <h2 class="text-5xl font-bold text-white mb-3 drop-shadow-lg">Â¡BINGO!</h2>
                    <p class="text-white text-2xl font-semibold mb-2">Â¡Felicidades, HAS GANADO!</p>
                    <div class="flex items-center justify-center gap-2 text-white text-lg mt-4 bg-white/20 rounded-2xl p-4">
                        <span class="text-3xl">ğŸ“¢</span>
                        <p class="font-bold">Avisa al presentador para reclamar tu premio</p>
                    </div>
                </div>
            </div>

            <!-- Grid de bingo -->
            <div id="bingoGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6"></div>

            <!-- Mensaje de estado -->
            <div class="glass rounded-2xl p-6 text-center slide-up">
                <p id="statusMessage" class="text-gray-700 font-medium text-lg">
                    â³ Esperando que el presentador active las preguntas...
                </p>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            "Alguien que haya venido desde muy lejos",
            "Alguien que cumple aÃ±os este mes",
            "Alguien que vino sin acompaÃ±ante",
            "Alguien que tenga hijos",
            "Alguien que se va a casar pronto",
            "Alguien que ya celebrÃ³ 25 aÃ±os de matrimonio",
            "Alguien que conociÃ³ a Arnick primero",
            "Alguien que conociÃ³ a Paola primero",
            "Alguien que estuvo presente cuando se hicieron pareja",
            "Alguien que llorÃ³ durante la ceremonia ğŸ’€",
            "Alguien que tenga corbata del mismo color que la decoraciÃ³n",
            "Alguien que combine colores con su pareja"
        ];

        let database;
        let playerName = '';
        let playerId = '';
        let markedCells = new Set();
        let activeQuestions = new Set();
        let hasWon = false;

        // ConfiguraciÃ³n de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyChk6NG_e9KSNL40iDq8fvrnuqsW55ZzrY",
            authDomain: "bingo-boda-arnick-paola.firebaseapp.com",
            databaseURL: "https://bingo-boda-arnick-paola-default-rtdb.firebaseio.com",
            projectId: "bingo-boda-arnick-paola",
            storageBucket: "bingo-boda-arnick-paola.firebasestorage.app",
            messagingSenderId: "40905188995",
            appId: "1:40905188995:web:ef75c57e678ca615195db6"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        database = firebase.database();

        // Escuchar cambios en preguntas activas
        database.ref('activeQuestions').on('value', (snapshot) => {
            const data = snapshot.val();
            activeQuestions = new Set(data ? Object.keys(data).map(Number) : []);
            if (playerId) createGrid();
            updateStatus();
        });

        function registerPlayer() {
            const input = document.getElementById('playerNameInput');
            playerName = input.value.trim();
            
            if (!playerName) {
                input.classList.add('border-red-500');
                input.placeholder = 'Â¡Por favor escribe tu nombre!';
                setTimeout(() => {
                    input.classList.remove('border-red-500');
                    input.placeholder = 'Escribe tu nombre aquÃ­...';
                }, 2000);
                return;
            }
            
            playerId = `player_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('playerNameDisplay').textContent = playerName;
            
            // Guardar jugador en Firebase
            database.ref(`players/${playerId}`).set({
                playerName,
                markedCells: [],
                hasWon: false,
                joinTime: Date.now()
            });

            // Escuchar cambios en el jugador
            database.ref(`players/${playerId}`).on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    markedCells = new Set(data.markedCells || []);
                    hasWon = data.hasWon || false;
                    createGrid();
                }
            });

            createGrid();
        }

        function createGrid() {
            const grid = document.getElementById('bingoGrid');
            grid.innerHTML = '';
            
            questions.forEach((question, index) => {
                const isMarked = markedCells.has(index);
                const isActive = activeQuestions.has(index);
                const canClick = isActive && !hasWon;
                
                const button = document.createElement('button');
                button.className = `p-5 rounded-2xl transition-all duration-300 text-left relative transform slide-up ${
                    isMarked
                        ? 'bg-gradient-to-br from-purple-500 via-pink-500 to-purple-600 text-white shadow-2xl scale-105 glow'
                        : isActive
                        ? 'glass text-gray-700 hover:shadow-xl hover:scale-105 border-2 border-purple-300'
                        : 'bg-gray-100/80 text-gray-400 cursor-not-allowed border-2 border-gray-200'
                }`;
                
                button.style.animationDelay = `${index * 0.05}s`;
                button.onclick = canClick ? () => toggleCell(index) : null;
                
                button.innerHTML = `
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ${
                            isMarked
                                ? 'bg-white/30 backdrop-blur text-white'
                                : isActive
                                ? 'bg-gradient-to-br from-purple-400 to-pink-400 text-white'
                                : 'bg-gray-300 text-gray-500'
                        }">
                            ${isMarked ? 'âœ“' : index + 1}
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-semibold leading-snug ${
                                isMarked ? 'text-white' : isActive ? 'text-gray-800' : 'text-gray-400'
                            }">
                                ${question}
                            </p>
                            ${isActive && !isMarked 
                                ? '<div class="flex items-center gap-1 mt-2"><div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div><span class="text-xs text-gray-600 font-medium">Activa</span></div>' 
                                : ''
                            }
                            ${isMarked 
                                ? '<div class="text-xs text-white/90 font-medium mt-2">âœ“ Completada</div>' 
                                : ''
                            }
                        </div>
                    </div>
                `;
                
                grid.appendChild(button);
            });
            
            updateProgress();
        }

        function toggleCell(index) {
            const newMarked = new Set(markedCells);
            if (newMarked.has(index)) {
                newMarked.delete(index);
            } else {
                newMarked.add(index);
            }
            
            markedCells = newMarked;
            const markedArray = Array.from(markedCells);
            
            database.ref(`players/${playerId}`).update({
                markedCells: markedArray,
                hasWon: markedArray.length === 12,
                winTime: markedArray.length === 12 ? Date.now() : null
            });

            if (markedArray.length === 12 && !hasWon) {
                hasWon = true;
                showWinner();
                createConfetti();
            }
        }

        function showWinner() {
            document.getElementById('winnerBanner').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function createConfetti() {
            const container = document.getElementById('confettiContainer');
            const emojis = ['ğŸ‰', 'ğŸŠ', 'âœ¨', 'ğŸˆ', 'ğŸ’•', 'ğŸŒŸ', 'â­', 'ğŸ’«', 'ğŸ†', 'ğŸ‘'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti absolute text-4xl';
                    confetti.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    container.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 4000);
                }, i * 50);
            }
        }

        function updateProgress() {
            document.getElementById('progressCount').textContent = `${markedCells.size}/12`;
        }

        function updateStatus() {
            const status = document.getElementById('statusMessage');
            if (activeQuestions.size === 0) {
                status.innerHTML = 'â³ Esperando que el presentador active las preguntas...';
            } else {
                status.innerHTML = `<span class="text-purple-700">âœ¨ ${activeQuestions.size} preguntas activas</span><br><span class="text-sm text-gray-600">Â¡Encuentra personas y marca las casillas!</span>`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const input = document.getElementById('playerNameInput');
            if (input) {
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') registerPlayer();
                });
            }
        });
    </script>
</body>
</html>
